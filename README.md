# Facial Recognition on Google Photos

### Project Overview:

This project aims to create an image classification system for personal Google Photos, using 
deep learning models and computer vision techniques. Unlike typical facial recognition algorithms, 
the project will use a custom dataset and apply transfer learning to extract high-level features 
from pre-trained models such as Inception and ResNet. Due to the limited amount of data available, 
the project will also implement data preprocessing techniques including data augmentation, cropping, 
and rotation, as well as potentially using deep learning models like Generative Adversarial 
Networks (GAN) or Autoencoders to generate more data. The end result will be a custom model 
that is fine-tuned to accurately classify images in the user's Google Photos collection.

### Requirements:

We can install all the required libraries using following command.

```python
pip3 install -r requirements.txt
```

### Model

The model is composed of several blocks, including Data Preparation, Object Detection, Transfer Learning 
for Feature Extraction, and Fine-tuning. To prepare the data, I utilized the Google Photos website to 
select specific individuals' photos and then utilized Google API client services to download the data to 
my local device. Object detection was performed using the YOLO (You Only Look Once) technique. Feature 
extraction was achieved using various models such as MobileNet, ResNet, Inception, and Inception-ResNet. 
The visual representation of model can be shown as below

![Model](https://github.com/umesh-gattem/CV_Project/blob/master/CV%20Project%20Model.png)

### Dataset:

I have selected 5 categories from the Google Photos Albums, comprising approximately 400-500 images each, 
after manually sorting and filtering through individual photos. To read the albums from Google photos, 
I utilized GoogleAPIClient. However, to use Google APIs, we require a token file or a secret json file, 
which can be generated by creating credentials on the Google Cloud Console website. With this credentials json file, 
we can connect to the Google Cloud Console and access any of the Google APIs, including photos, drive, and Google mail. 
Once the credentials file is obtained, we can access any album from Google Photos, download and save the photos to local.

Run following file to get all the albums and the images of your Google Photos.

```python
python3 GooglePhotosAPI/read_photos_from_albums.py
 ```
 
Note: To run the above file we need to have GooglePhotos.json which is a credential file we need to create from Google Cloud Console.

### YOLO Model

The YOLO model used in this project is trained on the COCO dataset and can detect 80 classes of objects, such as 
people, cars, airplanes, dogs, fire hydrants, and stop signs. We need to run YOLO model to get boundary boxes of the 
images with person image.

We can run the YOLO model using the following command.

```python
python3 yolo_model/yolo_object_detection.py
```
When we run above file it creates the folders of all input data with the boundary boxes of all images.

### Feature Extraction

Once all the images are created with the yolo_predictions we need to extract features using the transfer learning. 
For transfer learning I am using 4 differnet models which are MobileNet, ResNet, Inception, Inception-ResNet models.

We can run those models using following command. 

```python
python3 mobile_net/mobile_net_model.py
python3 resnet/resnet_model.py
python3 inception/inception_model.py
python3 inception_resnet/inception_resnet_model.py
```

By running above file it will run feature extraction and fine-tune the model for 10 epochs.

Note : I didn't push any of the data since image data is more and 
it can't be pushed through git. I am trying to push data and saved model to 
google drive where you can download and run the above files in your local. At currently you can't run any of these files. 


